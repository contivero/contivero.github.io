---
title: Concrete Mathematics, Chapter 1, homework exercises (part 1)
---
## Exercise 8:

Not much to add to the book answers really:
$$\begin{aligned}
Q_0 &= \alpha\\
Q_1 &= \beta\\
Q_2 &= \dfrac{1 + \beta}{\alpha}\\
Q_3 &= \dfrac{1 + Q_2}{Q_1} = \dfrac{1+\frac{1+\beta}{\alpha}}{\beta} = \dfrac{1 + \alpha + \beta}{\alpha \beta}\\
Q_4 &= \dfrac{1 + \frac{1 + \alpha + \beta}{\alpha\beta}}{\frac{1 + \beta}{\alpha}} = \dfrac{\frac{\alpha\beta + 1 + \alpha + \beta}{\alpha\beta}}{\frac{1+\beta}{\alpha}} = \frac{\alpha\beta + 1 + \alpha + \beta}{(1+\beta)\beta} = \frac{(\alpha + 1)(\beta +1)}{(\beta +1)\beta}\\
&= \frac{1+\alpha}{\beta}\\
Q_5 &= \alpha\\
Q_6 &= \beta
\end{aligned}$$

## Exercise 9:

### a)
Setting $x_n$ to the value said in the exercise, and plugging it in the inequality:

$$x_1 \cdots \frac{x_1 + \cdots + x_{n-1}}{n-1} \leqslant
\left(\frac{x1+\cdots+ [ \frac{x_1+\cdots+x_{n-1}}{n-1} ] }{n} \right)^n$$

Working with the right-hand side of the P(n) inequality:

$$\left(\frac{(n-1)x_1 + \cdots + (n-1) x_{n-1} + x_1 + \cdots + x_{n-1}}{n(n-1)}\right)^n =
\\
\\
\\ = \left(\frac{n(x_1 + \cdots + x_{n-1})}{n(n-1)}\right)^n = \left(\frac{ x_1 + \cdots + x_{n-1}}{n-1}\right)^n$$

So in the end, we have:

$$P(n): x_1 \cdots x_{n-1} \left(\dfrac{ x_1 + \cdots + x_{n-1}}{n-1}\right) \leqslant \left(\dfrac{x_1+\dots+x_{n-1}}{n-1}\right)^{n-1} \left(\dfrac{ x_1 + \cdots + x_{n-1}}{n-1}\right)$$

$$x_1 \cdots x_{n-1} \leqslant \left(\dfrac{x_1+\dots+x_{n-1}}{n-1}\right)^{n-1}$$

And this is exactly $P(n-1) \therefore P(n) \implies P(n-1)$

### b)
We know the following two things:
$$P(n): x_1 \cdots x_n \leqslant \left(\dfrac{x_1 + \cdots + x_n}{n}\right)^2$$
$$P(2): x_1 x_2 \leqslant \left(\dfrac{x_1 + x_2}{2} \right)^2$$
Whenever you see (1) or (2) above an inequality, we are using one of the two
previous facts to justify the step:

$$x_1 \cdots x_n x_{n+1} \cdots x_{2n} \leqslant \left(\dfrac{x_1 + \cdots + x_n}{n} \right)^n \left(\dfrac{x_{n+1} + \cdots + x_{2n}}{n}\right)^n =
\\
\\ = \left[\left(\dfrac{x_1 + \cdots + x_n}{n}\right) \left(\dfrac{x_{n+1} + \cdots + x_{2n}}{n}\right)\right]^n \overset{\text{(2)}}{\leqslant}
\\
\\
\overset{\text{(2)}}{\leqslant} \left[\left(\dfrac{x_1 + \cdots + x_n}{2n} + \dfrac{x_{n+1} + \cdots + x_{2n}}{2n}\right)^2\right]^n = \left[\dfrac{x_1 + \cdots + x_{2n}}{2n}\right]^{2n}$$

Therefore $P(n) \land P(2) \implies P(2n)$

### c)
We won't prove it since the book doesn't ask us to, but to get the intuition as
to why, consider the following:

The base case is trivial:
$$P(1): x_1 \leqslant \dfrac{x_1}{1}^1 = x_1$$
Then:

  1) $P(n) \land P(2)$ covers all the even numbers.
  2) $P(n) \implies P(n-1)$ covers all the numbers from n to 2 (since the book says n>1).

So we can use (1) to prove P(n) for any arbitrarily large even number, and then
(2) to prove anything before that:

$$P(n) \land P(2) \underset{(1)}{\implies} P(4) \underset{(2)}{\implies} P(3) \underset{(1)}{\implies} P(6) \underset{(2)}{\implies} P(5) \implies \dots$$

## Exercise 10:

We play a bit with the clockwise Hanoi for small values of $Q_n$ and $R_n$. We
find, e.g.: $Q_1 = 1, Q_2 = 5, Q_3 = 15$, and $R_1 = 2, R_2 = 7, R_3 = 21$. We
notice that to go from B back to A, what we need to do is:

  1. first move (n-1) discs to A
  2. then move the base disc to C
  3. move (n-1) discs to B
  4. move the base disc to A
  5. finally move the remaining (n-1) discs to A

That is:

$$R_n = R_{n-1} + 1 + Q_{n-1} + 1 + R_{n-1}$$

Notice we haven't said anything about how to move them. All we know is we move
them in the optimal way (i.e. with the least amount of moves); that is our
assumption. We denote those ways by the recurrences $Q_n$ and $R_n$. To prove
the equality, we use induction over n.

##### Base case (n=1):
If we have no discs, then we do no moves, so $R_0 = Q_0 = 0$. With this in mind,
$R_1 = R_0 + 1 + Q_0 + 1 + R_0 = 2$

##### Induction hypothesis:
$R_{n-1}$ is optimal

##### Proof:
$$R_n = \overbrace{R_{n-1}}^\text{[1]} + \underbrace{1}_\text{[2]} + \overbrace{Q_{n-1}}^\text{[3]} + \underbrace{1}_\text{[4]} + \overbrace{R_{n-1}}^\text{[1]}$$

  1. optimal by inductive hypothesis.
  2. trivially optimal; the minimal amount of moves to move a disc is 1.
  3. optimal by definition of $Q_n$.
  4. idem [2].
  5. optimal by inductive hypothesis.

Then $R_n$ is optimal.

$\blacksquare$

We still haven't said what $Q_n$ looks like, but whatever it is, it is optimal.
Again, from having played with small values of n, we can see that:
$$Q_n = \overbrace{R_{n-1}}^\text{[1]} + \underbrace{1}_\text{[2]} + \overbrace{R_{n-1}}^\text{[3]} = 2R_{n-1} + 1$$

  1. Move (n-1) discs from A to C.
  2. Move the base disc from A to B.
  3. Move (n-1) discs from C to B.

We have to prove that this is optimal, and we do it by induction on n:

##### Base case(n=1):
No discs, no moves, then $Q_0 = R_0 = 0$, and we have:
$Q_1 = 2R_0 + 1 = 1$

##### Induction hypothesis:
$Q_n = 2R_{n-1} + 1$ is optimal

##### Proof:
$$Q_{n+1} = 2R_n + 1$$
By the same reasoning mentioned before, we first have to move the first n discs
to C, then the base in one move from A to B, and finally the n discs once more
from C to B. The first and third steps are optimal by the inductive hypothesis,
the second one is optimal because we need at least one move to go from A to B,
and that is exactly what we are doing. Therefore, $Q_{n+1}$ is optimal.

$\blacksquare$

Something implicit in all these proofs is that it works because we have only 3
pegs. We must build the tower of size $(n-1)$ in one peg before we can move the
base precisely because there are only 3 pegs. The destination peg must be empty
to transfer the base, another has to contain only the nth element so we can move
it to the destination peg, which leaves us with the rest of the discs in a
single peg. That the minimal amount of moves to build the tower of size n comes
from building in an optimal way the tower of size $(n-1)$ in another peg isn't
true when we have more pegs (as in the 4 pegs problem in the exam and research
exercises in the book).

## Exercise 11:

We try small values and find $A_1 = 2, A_2 = 6, A_3 = 14$. The reasoning is the
same as before, so I'll skip the proof (and it isn't asked either). I see no
reason to add to the book answers.

$$A_n = A_{n-1} + 2 + A_{n-1} = \overbrace{A_{n-1} + 1}^{T_n} +\overbrace{A_{n-1} + 1}^{T_n}  = 2T_n = 2^{n+1} -2$$

### b)
Although harder to think about, after some time we see that $B_1 = 3, B_2 = 11,
B_3 = 27$, and the following formula suggests itself:

$$B_n = A_{n-1} + 2 + A_{n-1} + 2 + B_{n-1}$$

  1. Move the $(n-1)$ tower to the destination peg ignoring the order.
  2. Move the bottom two discs to the middle peg leaving them inverted.
  3. Move the $(n-1)$ tower back to the original peg, ignoring the order. As we went back and forth, it is now ordered.
  4. Move the bottom two discs to the destination; they now end ordered.
  5. Move the $(n-1)$ tower to the destination, this time caring about the order.

Therefore:

$$\begin{aligned}
B_n &= 2A_{n-1} + 4 + B_{n-1} \\
&= 2(2^n - 2) + 4 + B_{n-1} \\
&= 2^{n+1} + B_{n-1} \\
&= 2^{n+1} + \sum_{i=2}^{n-1} 2^{i+1} + 3 \\
&= 2^{n+1} + (1\dots 1000)_2 + (0\dots 0011)_2 \\
&= 2^{n+1} + (1\dots 1011)_2 \\
&= 2^{n+1} + 2^{n+1} - 5 = 2^{n+2} - 5
\end{aligned}$$

## Exercise 12:

For $n = 1$, we need as many moves as discs we have, so $A(m_1) = m_1$.
For $n > 1$, the pattern is the same as the normal tower of Hanoi problem, but
more generalized. In other words, we build the smaller tower, transfer the base
discs, and move the smaller tower once more:

$$\begin{aligned}
A(m_1, \dots, m_n) &= 2A(m_1, \dots, m_{n-1}) + m_n \\
&= 2A(m_1, \dots, m_{n-2}) + 2m_{n-1} + m_n \\
&= 2^{n-1}m_1 + 2^{n-2}m_2 + \cdots + 2m_{n-1} + m_n = \sum_{i=0}^{n-1} 2^i m_{n-i}
\end{aligned}$$

## Exercise 13:

As always, we try drawing for low values of n. For n = 1, we get $ZZ_1 = 2$; for n = 2:

![$ZZ_2 = 12$](../images/12regions.png)

Since each zig-zag has 3 segments, and each segment can cross 3 segments of
another line, each line can cross the another in 9 different points. Then:

$ZZ_n = ZZ_{n-1} + 2 + [9(n-1) - 1]$

  1. Regions from the previous $(n-1)$ lines
  2. Two new infinite regions
  3. The nth line crosses the other (n-1) lines in 9 points. If k = 9(n-1) distinct points are crossed, we get (k-1) new bounded regions.

$$\begin{aligned}
ZZ_n &= ZZ_{n-1} + 9n - 8 \\
&=ZZ_{n-2} + 9(n-1) + 9n - 8 - 8 \\
& \enspace \vdots \\
&= 9 +9\cdot 2 + \cdots + 9n - 8n + Z_0 \\
&= 9S_n - 8n + 1 \\
&= 9\frac{n(n+1)}{2} -8n + 1 \\
&= \frac{9}{2}n^2 - \frac{7}{2}n + 1
\end{aligned}$$

## Exercise 14:

This is easy to visualize up to n = 3, but then it gets harder. The sequence is
known as the [cake number](https://oeis.org/A000125). The first six values are:
$P_0 = 1, P_1 = 2, P_2 = 4, P_3 = 8, P_4 = 15, P_5 = 26$. Up till $n = 3$ it
would seem that we are dealing with powers of two, but we stumble with the same
problem we had in the book with lines in 2D. The same way a third line can't cut
every region in 2D, a fourth plane can't cut every region in 3D. When we add the
nth plane, we have the regions of the previous $(n-1)$ planes, plus the number
of 2-dimensional regions defined in the new plane by its intersection with the
rest.
$$P_n = P_{n-1} + L_{n-1} = P_{n-1} + \frac{n(n+1)}{2} + 1$$
For a closed formula, we need to wait until chapter 5, which covers the necessary tools.

## Exercise 15:

Trying by hand a couple of values, we can create a table, with the values in
decimal, and binary notation.

![Numbers in decimal and binary notation](../images/table21.png)

The binary representation, and the values of $I(n)$, suggest that the two
leading bits are important. If we write $n$ as $n = 2^m + 2^{m-1} + k$, where
$m$ is the position of the most significant bit at the start of the batch, then
$I(n) = 2k+1$, where $0\leqslant k < 2^m +2^{m-1}$.

Another way of seeing it is the following. If we define k to be whatever number
is at the right of the two leading digits, then:

1. If the two leading digits are 11, $I(n) = 2k+1$.
2. Otherwise, if the two leading digits are 10, we define x to be the power of
   two closest but smaller, to the start of the batch (e.g. for the 3 batch it
   is 2, for the 6 batch it is 4, for the 12 batch it is 8; basically dropping
   the rightmost 1 from the binary representation of the first batch number) and
   then $I(n) = x + 2k+1$, where k is as defined in (1).


## Exercise 16:

We are given the general recurrence relation:
$$\begin{aligned}
g(1) &= \alpha \\
g(2n+j) &=3g(n) + \gamma n + \beta_j, \text{for } j = 0, 1 \land n \geqslant 1
\end{aligned}$$
Lets write it explicitly to make it clearer:
$$\begin{aligned}
g(1) &= \alpha \\
g(2n) &=3g(n) + \gamma n + \beta_0 \\
g(2n+1) &=3g(n) +\gamma n + \beta_1
\end{aligned}$$
If we write a table of the first values, we can see that $A(n) = 3^m, \text{ when } n = 2^m + l, 0 \leqslant l < 2^m$.

![Numbers in decimal and binary notation](../images/table3.png)

There are some other patterns too, but we won't be using this. However, the
table hints at a possible rewrite of g(n):
\\[
g(n) = a(n)\\alpha + b(n)\\beta _0+ c(n)\\beta_1 + d(n)\\gamma
\\]
For a proof that doing this is valid, see at the end. By setting $\gamma = 0$,
we can reuse the radix-changing solution as explained on page 16. In our case d
= 2 and c = 3, so we are going to be changing from radix 2 to 3.
\\[
g(n) = a(n)\\alpha + b(n)\\beta_0 + c(n)\\beta_1 = (\\alpha_{b_m} \\beta_{b_{m-1}} \\dots \\beta_{b_1} \\beta_{b_0})_3
\\]
We set $(\alpha, \beta_0, \beta_1, \gamma) \to (0,0,0,1)$, to find a value for
$c(n)$ which we will later use:
\\[
c(n) = (\\beta_{b_{m-1}} \\dots \\beta_{b_1} \\beta_{b_0})_3
\\]
We are missing d(n), so we set g(n) = n (following the hint given), and see
where it leads to:

$$\begin{aligned}
g(1) &= 1 = \alpha \\
g(2n) &= 2n = 3n + \gamma n + \beta_0 \\
g(2n+1) &= 2n + 1 = 3n +\gamma n + \beta_1
\end{aligned}$$

This gives us $\alpha = 1, \beta_0 = 0, \beta_1 = 1, \gamma = -1$, meaning:
\\[n = a(n) + c(n) - d(n)\\]
We multiply both sides by $\gamma$ and solve for $d(n)\gamma$, which we will
need at the end:
$$\begin{aligned}
d(n)\gamma &= a(n)\gamma + c(n)\gamma -n\gamma\\
&= (100\dots 0)_3\gamma + (\beta_{b_{m-1}} \dots \beta_{b_1} \beta_{b_0})_3\gamma -n\gamma \\
&= (1\beta_{b_{m-1}} \dots \beta_{b_1} \beta_{b_0})_3\gamma -n\gamma
\end{aligned}$$
So in summary, we have:
$$\begin{aligned}
g(n) &= a(n)\alpha + b(n)\beta _0+ c(n)\beta_1 + d(n)\gamma \\
&= (\alpha_{b_m} \beta_{b_{m-1}} \dots \beta_{b_1} \beta_{b_0})_3 + d(n)\gamma \\
&= (\alpha_{b_m} \beta_{b_{m-1}} \dots \beta_{b_1} \beta_{b_0})_3 + \gamma(1 \beta_{b_{m-1}} \dots \beta_{b_1} \beta_{b_0})_3 -n)
\end{aligned}$$

##### Proof:
Although the book doesn't do it (it just says it is possible, and that the
calculations are "messy and uninformative"), we will for the sake of
completeness.

For $n \geq 1$ we have:

$$\begin{aligned}
g(2n) & = 3g(n) + \gamma n + \beta_0\\
& = 3[a(n)\alpha  + b(n)\beta_0 + c(n)\beta_1 + d(n)\gamma] + \gamma n + \beta_0\\
& = 3a(n)\alpha + (3b(n) + 1)\beta_0 + 3c(n)\beta_1 + (3d(n) + n)\gamma \\
\end{aligned}$$

Therefore if we set:
$$
\begin{aligned}
a(2n) &= 3a(n)\\
b(2n) &= 3b(n) + 1\\
c(2n) &= 3c(n)\\
d(2n) &= 3d(n) + n\\
\end{aligned}
$$
we get:
\\[
g(2n) = a(2n)\\alpha + b(2n) \\beta_0 + c(2n)\\beta_1 + d(2n)\\gamma
\\]
For the odd values:
$$
\begin{aligned}
g(2n+1) & = 3g(n) + \gamma n + \beta_1\\
& = 3[a(n)\alpha  + b(n)\beta_0 + c(n)\beta_1 + d(n)\gamma]+ \gamma n + \beta_1\\
& = 3a(n)\alpha + 3b(n) \beta_0 + (3c(n) + 1)\beta_1 + (3d(n) + n)\gamma \\
\end{aligned}
$$
In this case we have:
$$\begin{aligned}
a(2n+1) &= 3a(n)\\
b(2n+1) &= 3b(n)\\
c(2n+1) &= 3c(n) + 1\\
d(2n+1) &= 3d(n) + n
\end{aligned}$$
Finally, we set the initial values to $a(1) = 1$,
and the rest initial values to 0, to respect the base case. Summarizing the
recurrences:
$$\begin{aligned}
a(1)    &= 1        & & & b(1) &= 0\\
a(2n)   &= 3a(n)   & & & b(2n) &= 3b(n)+1 \\
a(2n+1) &= 3a(n) & & & b(2n+1) &= 3b(n) \\
\\
c(1)    &= 1          & & & d(1) &= 0 \\
c(2n)   &= 3c(n)     & & & d(2n) &= 3d(n)+n \\
c(2n+1) &= 3c(n)+1 & & & d(2n+1) &= 3d(n)+n \\
\end{aligned}$$

This whole exercise took some time to process. Some relevant links discussing it:

  * [Math.stackexchange answer](http://math.stackexchange.com/a/1081060)
  * [Mathematical explanation of the repertoire method](http://blog.wakatta.jp/blog/2012/01/14/concrete-mathematics-repertoire-method/)
